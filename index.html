<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2030 Fuel Efficiency</title>
    <link rel="stylesheet" href="index.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;700;900&display=swap"
        rel="stylesheet">
</head>

<body>
    <nav class="top-nav">
        <div class="nav-content">
            <span class="logo">EcoCalc Pro</span>
        </div>
    </nav>

    <div class="steps-container" id="steps-container">

        <!-- Step 0: Hero / Start -->
        <section class="step active" id="step-0">
            <div class="step-content text-center">
                <h1 class="hero-title">未来の基準を、<br>今、測ろう。</h1>
                <p class="hero-subtitle">あなたの愛車は2030年度の燃費基準を満たしているか。<br>簡単な質問で判定します。</p>
                <button class="action-btn primary" onclick="nextStep(1)">判定をはじめる</button>
            </div>
            <div class="scroll-indicator">
                <span>はじめる</span>↓
            </div>
        </section>

        <!-- Step 1: Category -->
        <section class="step" id="step-1">
            <div class="step-content">
                <h2 class="step-title">車の「タイプ」は？</h2>
                <p class="step-desc">お乗りの車のボディタイプを選択してください。</p>

                <div class="selection-grid">
                    <div class="select-card" onclick="selectOption('category', 'compact', 2)" tabindex="0">コンパクトカー</div>
                    <div class="select-card" onclick="selectOption('category', 'sedan', 2)" tabindex="0">セダン / ハッチバック
                    </div>
                    <div class="select-card" onclick="selectOption('category', 'suv', 2)" tabindex="0">SUV / クロカン</div>
                    <div class="select-card" onclick="selectOption('category', 'minivan', 2)" tabindex="0">ミニバン / ワゴン
                    </div>
                    <div class="select-card" onclick="selectOption('category', 'sports', 2)" tabindex="0">スポーツカー</div>
                    <div class="select-card" onclick="selectOption('category', 'kei', 2)" tabindex="0">軽自動車</div>
                </div>

                <div class="nav-buttons">
                    <button class="nav-btn prev" onclick="prevStep(0)">戻る</button>
                    <!-- Auto-advance on selection -->
                </div>
            </div>
        </section>

        <!-- Step 2: Powertrain -->
        <section class="step" id="step-2">
            <div class="step-content">
                <h2 class="step-title">エンジン種類は？</h2>
                <p class="step-desc">パワートレイン（動力源）を選択してください。</p>

                <div class="selection-grid">
                    <div class="select-card" onclick="selectOption('powertrain', 'gasoline', 3)" tabindex="0">ガソリン</div>
                    <div class="select-card" onclick="selectOption('powertrain', 'hev', 3)" tabindex="0">ハイブリッド (HEV)
                    </div>
                    <div class="select-card" onclick="selectOption('powertrain', 'phev', 3)" tabindex="0">プラグインハイブリッド
                        (PHEV)</div>
                    <div class="select-card" onclick="selectOption('powertrain', 'diesel', 3)" tabindex="0">クリーンディーゼル
                    </div>
                    <div class="select-card" onclick="selectOption('powertrain', 'lpg', 3)" tabindex="0">LPG</div>
                </div>

                <div class="nav-buttons">
                    <button class="nav-btn prev" onclick="prevStep(1)">戻る</button>
                </div>
            </div>
        </section>

        <!-- Step 3: Weight -->
        <section class="step" id="step-3">
            <div class="step-content">
                <h2 class="step-title">車の「重さ」は？</h2>
                <p class="step-desc">車検証などを確認し、車両重量（kg）を入力してください。</p>

                <div class="input-wrapper">
                    <input type="number" id="weight" placeholder="0" min="500" max="5000" inputmode="numeric">
                    <span class="input-unit">kg</span>
                </div>

                <div class="nav-buttons">
                    <button class="nav-btn prev" onclick="prevStep(2)">戻る</button>
                    <button class="nav-btn next" onclick="nextStep(4)" id="btn-next-weight" disabled>次へ</button>
                </div>
            </div>
        </section>

        <!-- Step 4: WLTC -->
        <section class="step" id="step-4">
            <div class="step-content">
                <h2 class="step-title">カタログ燃費は？</h2>
                <p class="step-desc">車検証等に記載された測定モードとその燃費を入力してください。</p>

                <div class="segmented-control" id="mode-selector">
                    <div class="segment active" onclick="selectMode('wltc')">WLTC</div>
                    <div class="segment" onclick="selectMode('jc08')">JC08</div>
                    <div class="segment" onclick="selectMode('1015')">10・15</div>
                </div>

                <div class="input-wrapper" style="margin-top: 24px;">
                    <input type="number" id="wltc" placeholder="0.0" min="1" max="100" step="0.1" inputmode="decimal">
                    <span class="input-unit">km/L</span>
                </div>

                <div class="converted-fe-display" id="converted-display" style="opacity: 0;">
                    推定WLTC換算: <span id="converted-val" style="font-weight: 700; color: var(--text-primary);">--</span>
                    km/L
                </div>

                <div class="nav-buttons">
                    <button class="nav-btn prev" onclick="prevStep(3)">戻る</button>
                    <button class="nav-btn next" onclick="calculateAndShowResult()" id="btn-next-wltc"
                        disabled>結果を見る</button>
                </div>
            </div>
        </section>

        <!-- Step 5: Result -->
        <section class="step result-step" id="step-5">
            <div class="step-content result-content">
                <div class="result-header">
                    <h2 class="result-title">判定結果</h2>
                    <p class="result-message" id="achievement-text">ここに評価コメントが入ります。</p>
                </div>

                <div class="sticker-showcase">
                    <div class="sticker-container">
                        <img src="sticker_clean.png" alt="燃費基準達成ステッカー" class="sticker-image">
                        <div class="sticker-content">
                            <div class="sticker-title">2030年度<br>燃費優良車</div>
                            <div class="sticker-stars-overlay" id="sticker-stars-overlay">
                                <!-- JS injects stars here -->
                            </div>
                        </div>
                    </div>
                </div>

                <div class="result-stats">
                    <div class="stat-item main-stat">
                        <span class="stat-label">獲得した星</span>
                        <div class="star-announcement">
                            <span class="highlight-star" id="star-count-display">0</span>
                        </div>
                    </div>
                    <div class="stat-grid">
                        <div class="stat-item">
                            <span class="stat-label">達成率</span>
                            <span class="stat-val highlight"><span id="achievement-rate">0</span>%</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">2030年 目標水準</span>
                            <span class="stat-val"><span id="target-fe">0</span> km/L</span>
                        </div>
                    </div>
                </div>

                <div class="action-footer">
                    <button class="action-btn primary" onclick="shareResult()">
                        <svg viewBox="0 0 24 24" width="20" height="20" stroke="currentColor" stroke-width="2"
                            fill="none" stroke-linecap="round" stroke-linejoin="round"
                            style="margin-right:8px; vertical-align:middle;">
                            <circle cx="18" cy="5" r="3"></circle>
                            <circle cx="6" cy="12" r="3"></circle>
                            <circle cx="18" cy="19" r="3"></circle>
                            <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line>
                            <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line>
                        </svg>
                        結果をシェアする
                    </button>
                    <button class="nav-btn" style="margin-top: 20px; text-decoration: underline;"
                        onclick="resetApp()">最初からやり直す</button>
                </div>
            </div>
        </section>

    </div>

    <script src="script.js"></script>
</body>

</html>